import{d as zt,a as X,p as Jt,m as Xt,f as De,L as Oe,g as Zt}from"./moduleId.js";const Qt="module-metadata.js",en="module.js",fe=e=>({succeeded:!1,...e}),pt=e=>!e||e.trim().length===0;var Pe;(function(e){e[e.All=1]="All",e[e.Trace=2]="Trace",e[e.Debug=3]="Debug",e[e.Info=4]="Info",e[e.Warn=5]="Warn",e[e.Error=6]="Error",e[e.Off=7]="Off"})(Pe||(Pe={}));var xe;(function(e){e.Pending="Pending",e.Ready="Ready",e.Error="Error"})(xe||(xe={}));var Be;(function(e){e.ModuleDiscoveryFailed="ModuleDiscoveryFailed",e.InvalidDiscoveredModule="InvalidDiscoveredModule"})(Be||(Be={}));var Le;(function(e){e.ContributionsDiscoveryFailed="ContributionsDiscoveryFailed",e.InvalidDiscoveredContributions="InvalidDiscoveredContributions"})(Le||(Le={}));var Ne;(function(e){e.ModuleLoadingFailed="ModuleLoadingFailed",e.InvalidLoadedModule="InvalidLoadedModule"})(Ne||(Ne={}));var Fe;(function(e){e.ModuleActivationFailed="ModuleActivationFailed"})(Fe||(Fe={}));var Ue;(function(e){e.MessageListenerFailed="MessageListenerFailed",e.SendAskMessageTimeout="SendAskMessageTimeout"})(Ue||(Ue={}));var We;(function(e){e.PluginActivationFailed="PluginActivationFailed",e.ModuleResolverStrategyFailed="ModuleResolverStrategyFailed",e.ModuleLifecycleEventObserverFailed="ModuleLifecycleEventObserverFailed"})(We||(We={}));var $e;(function(e){e.Unknown="Unknown"})($e||($e={}));var Ve;(function(e){e.NotStarted="NotStarted",e.InProgress="InProgress",e.Success="Success",e.Failure="Failure"})(Ve||(Ve={}));var je;(function(e){e.WebWorker="worker.js",e.IFrame="iFrame.html"})(je||(je={}));var He;(function(e){e.FailedFetch="FAILED_FETCH",e.InvalidRequest="INVALID_REQUEST",e.FailedCsp="FAILED_CSP"})(He||(He={}));var P;(function(e){e.PackageName="packageName",e.MajorVersion="majorVersion",e.AliasName="aliasName",e.AccountId="accountId",e.Region="region",e.CacheInvalidator="cacheInvalidator",e.SucceedOnRetry="succeedOnRetry"})(P||(P={}));var we;(function(e){e.PackageName="packageName",e.MajorVersion="majorVersion",e.AliasName="aliasName",e.AccountId="accountId",e.SessionDifferentiator="sessionDifferentiator",e.ConsoleRegion="consoleRegion",e.UnifiedConsoleLoaderPackageName="unifiedConsoleLoaderPackageName",e.ParentOrigin="parentOrigin",e.LayoutBackgroundColorToken="layoutBackgroundColorToken",e.AwsUiVisualRefresh="awsuiVisualRefresh",e.Modal="modal"})(we||(we={}));var v=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tn(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),n}var ht={},G={},Z={};Object.defineProperty(Z,"__esModule",{value:!0});Z.TELEMETRY_CONFIG_MISSING_MSG=void 0;Z.TELEMETRY_CONFIG_MISSING_MSG="[TangerineBox] Telemetry configuration is missing, events will not be emitted";var L={},pe={},vt={},_={},W=v&&v.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(_,"__esModule",{value:!0});_.RefreshCredentialError=_.InvalidCredentialsError=_.MetaTagParsingError=_.TelemetryBrokerNotAvailableError=_.FailureRequestError=_.TerminalRequestError=_.TangerineBoxError=void 0;var $=function(e){W(t,e);function t(n,r){var a=e.call(this,n)||this;return a.message=n,a.originalError=r,a.name=a.constructor.name,r&&(a.stack+=`
Caused by: `+r.stack),a}return t}(Error);_.TangerineBoxError=$;var nn=function(e){W(t,e);function t(n,r){var a=e.call(this,n)||this;return a.message=n,a.metadata=r,a}return t}($);_.TerminalRequestError=nn;var rn=function(e){W(t,e);function t(n,r){var a=e.call(this,n)||this;return a.message=n,a.metadata=r,a}return t}($);_.FailureRequestError=rn;var on=function(e){W(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}($);_.TelemetryBrokerNotAvailableError=on;var an=function(e){W(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}($);_.MetaTagParsingError=an;var sn=function(e){W(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}($);_.InvalidCredentialsError=sn;var cn=function(e){W(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}($);_.RefreshCredentialError=cn;(function(e){var t=v&&v.__assign||function(){return t=Object.assign||function(c){for(var d,s=1,u=arguments.length;s<u;s++){d=arguments[s];for(var p in d)Object.prototype.hasOwnProperty.call(d,p)&&(c[p]=d[p])}return c},t.apply(this,arguments)},n=v&&v.__awaiter||function(c,d,s,u){function p(l){return l instanceof s?l:new s(function(h){h(l)})}return new(s||(s=Promise))(function(l,h){function g(y){try{f(u.next(y))}catch(T){h(T)}}function m(y){try{f(u.throw(y))}catch(T){h(T)}}function f(y){y.done?l(y.value):p(y.value).then(g,m)}f((u=u.apply(c,d||[])).next())})},r=v&&v.__generator||function(c,d){var s={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},u,p,l,h;return h={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(f){return function(y){return m([f,y])}}function m(f){if(u)throw new TypeError("Generator is already executing.");for(;s;)try{if(u=1,p&&(l=f[0]&2?p.return:f[0]?p.throw||((l=p.return)&&l.call(p),0):p.next)&&!(l=l.call(p,f[1])).done)return l;switch(p=0,l&&(f=[f[0]&2,l.value]),f[0]){case 0:case 1:l=f;break;case 4:return s.label++,{value:f[1],done:!1};case 5:s.label++,p=f[1],f=[0];continue;case 7:f=s.ops.pop(),s.trys.pop();continue;default:if(l=s.trys,!(l=l.length>0&&l[l.length-1])&&(f[0]===6||f[0]===2)){s=0;continue}if(f[0]===3&&(!l||f[1]>l[0]&&f[1]<l[3])){s.label=f[1];break}if(f[0]===6&&s.label<l[1]){s.label=l[1],l=f;break}if(l&&s.label<l[2]){s.label=l[2],s.ops.push(f);break}l[2]&&s.ops.pop(),s.trys.pop();continue}f=d.call(c,s)}catch(y){f=[6,y],p=0}finally{u=l=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.HttpClient=e.MAX_RETRIES=void 0;var a=_;e.MAX_RETRIES=4;var o=function(c){return c>=500||c===429},i=function(){function c(d){this.jsonReplacer=d}return c.prototype.call=function(d){var s,u,p;return n(this,void 0,void 0,function(){var l,h,g,m;return r(this,function(f){switch(f.label){case 0:l=new Date,h=0,f.label=1;case 1:if(!(h<=((s=d.maxRetries)!==null&&s!==void 0?s:e.MAX_RETRIES)))return[3,6];f.label=2;case 2:return f.trys.push([2,4,,5]),[4,this.callWithFetch(d,h)];case 3:return g=f.sent(),o(g.status)?[3,5]:[2,{finalHttpStatusCode:g.status,data:g.data,retries:h,startTimestamp:l,latencyMillseconds:new Date().getTime()-l.getTime(),maxRetriesExceeded:!1}];case 4:if(m=f.sent(),h>=((u=d.maxRetries)!==null&&u!==void 0?u:e.MAX_RETRIES)&&m instanceof Error)throw new a.TerminalRequestError(m.message,{finalHttpStatusCode:500,retries:h,code:m.metadata.code,startTimestamp:l,latencyMillseconds:new Date().getTime()-l.getTime(),maxRetriesExceeded:!0});return[3,5];case 5:return h++,[3,1];case 6:throw new a.TerminalRequestError("Too many retries",{finalHttpStatusCode:500,retries:(p=d.maxRetries)!==null&&p!==void 0?p:e.MAX_RETRIES,startTimestamp:l,code:"MaxRetriesExceeded",latencyMillseconds:new Date().getTime()-l.getTime(),maxRetriesExceeded:!0})}})})},c.prototype.callWithFetch=function(d,s){var u;return n(this,void 0,void 0,function(){var p,l,h,g,m,f,y;return r(this,function(T){switch(T.label){case 0:p={method:d.method,headers:t({"X-Retries":"".concat(s)},d.headers),keepalive:!0},d.timeout!==void 0&&d.timeout>0&&(l=new AbortController,setTimeout(function(){return l.abort()},d.timeout+s*(d.timeoutIncreasePerRetry||0)),p.signal=l.signal),d.method.toUpperCase()!=="GET"&&(p.body=this.createBody(d)),T.label=1;case 1:return T.trys.push([1,7,,8]),[4,fetch(d.url,p)];case 2:return h=T.sent(),g=(u=h?.headers)===null||u===void 0?void 0:u.get("Content-Type"),g&&/application\/json/.test(g)?[4,h.json()]:[3,4];case 3:return m=T.sent(),[2,{data:m,retries:s,status:h.status}];case 4:return[4,h.text()];case 5:return f=T.sent(),[2,{data:f,retries:s,status:h.status}];case 6:return[3,8];case 7:throw y=T.sent(),y instanceof Error&&y.name==="AbortError"?new a.FailureRequestError("Request timeout",{code:"RequestTimeout",finalHttpStatusCode:500,retries:s}):new a.FailureRequestError("Request encountered an error",{code:"RequestFailed",finalHttpStatusCode:500,retries:s});case 8:return[2]}})})},c.prototype.createBody=function(d){var s=d.data;return s?typeof s=="string"?s:typeof s=="object"?JSON.stringify(s,this.jsonReplacer):String(s):null},c}();e.HttpClient=i})(vt);var he={},V={},Q={};Object.defineProperty(Q,"__esModule",{value:!0});Q.TELEMETRY_BROKER_PROPERTY_NAME=void 0;Q.TELEMETRY_BROKER_PROPERTY_NAME="_internal_tb_telemetry_broker";var un=v&&v.__awaiter||function(e,t,n,r){function a(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(u){try{s(r.next(u))}catch(p){i(p)}}function d(u){try{s(r.throw(u))}catch(p){i(p)}}function s(u){u.done?o(u.value):a(u.value).then(c,d)}s((r=r.apply(e,t||[])).next())})},dn=v&&v.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,a,o,i;return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(s){return function(u){return d([s,u])}}function d(s){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,a&&(o=s[0]&2?a.return:s[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,s[1])).done)return o;switch(a=0,o&&(s=[s[0]&2,o.value]),s[0]){case 0:case 1:o=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,a=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1],o=s;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(s);break}o[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(u){s=[6,u],a=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(V,"__esModule",{value:!0});V.DataParser=void 0;var F=_,ln=Q,fn="aws-userInfo",pn="awsc-session-data",hn="__Secure-aws-session-id",vn=function(e){return"".concat(hn,"-").concat(e)},gn=function(){function e(t){this.windowWithTelemetryBroker=this.findWindowWithTelemetryBroker(),this.metaTagContentCache=t,this.sessionDataCache=this.parseSessionDataMetaTag(this.windowWithTelemetryBroker)}return e.getInstance=function(t){return this.metaDataProviderInstance||(this.metaDataProviderInstance=new e(t)),this.metaDataProviderInstance},e.prototype.getTelemetryBrokerWindow=function(){return this.windowWithTelemetryBroker},e.prototype.getMetaTagContent=function(){return this.metaTagContentCache||(this.metaTagContentCache=this.parseTangerineBoxMetaTag()),this.metaTagContentCache},e.prototype.getTelemetryMetaTagContent=function(){return this.telemetryMetaTagContentCache||(this.telemetryMetaTagContentCache=this.parseTangerineBoxTelemetryMetaTag()),this.telemetryMetaTagContentCache},e.prototype.getCredentialsConfig=function(){return{browserCredsFullPath:this.getMetaTagContent().browserCredsFullPath,csrfToken:this.getMetaTagContent().csrfToken}},e.prototype.parseTangerineBoxMetaTag=function(){var t=this.parseMetaTag("tb-data");if(!t)throw new F.MetaTagParsingError("TangerineBox meta tag not found");try{return JSON.parse(t)}catch(n){throw new F.MetaTagParsingError("Unable to parse TangerineBox meta tag contents",n instanceof Error?n:new Error(String(n)))}},e.prototype.parseTangerineBoxTelemetryMetaTag=function(){var t=this.parseMetaTag("tbt-data");if(!t)throw new F.MetaTagParsingError("TangerineBox Telemetry meta tag not found");try{return JSON.parse(t)}catch(n){throw new F.MetaTagParsingError("Unable to parse TangerineBox Telemetry meta tag contents",n instanceof Error?n:new Error(String(n)))}},e.prototype.parseMetaTag=function(t,n){var r=n?n.document:document,a=r.querySelector("meta[name='".concat(t,"']"));if(a)return a.content},e.prototype.parseCookie=function(t,n){n===void 0&&(n=document.cookie);var r=n.match("".concat(t,"=([^;]*)"));if(!(!r||!r[1]))return r[1]},e.prototype.triggerLoggedOutDialog=function(){var t=this.parseMetaTag("awsc-widget-nav")!==void 0||this.parseMetaTag("awsc-widget-next")!==void 0;typeof window<"u"&&(t?window.dispatchEvent(this.createCustomEvent("auth-change-detected")):window.AWSC&&typeof window.AWSC.jQuery=="function"&&window.AWSC.jQuery(window.AWSC).trigger("auth-change-detected"))},e.prototype.createCustomEvent=function(t){if(typeof window<"u"&&typeof window.CustomEvent=="function")return new CustomEvent(t);var n={bubbles:!1,cancelable:!1,detail:null},r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),r},e.prototype.parseSessionDataMetaTag=function(t){var n=this.parseMetaTag(pn,t);if(!n)throw new F.MetaTagParsingError("Session data meta tag not found");try{return JSON.parse(n)}catch(r){throw new F.MetaTagParsingError("Unable to parse session data meta tag content",r instanceof Error?r:new Error(String(r)))}},e.prototype.getSessionDataValue=function(t){return un(this,void 0,void 0,function(){return dn(this,function(n){return[2,this.sessionDataCache[t]]})})},e.prototype.getLogoutDetectionCookieName=function(){if(this.isPrismModeEnabled()){if(!this.sessionDataCache.sessionDifferentiator)throw new F.MetaTagParsingError("sessionDifferentiator is not found in prism mode");return vn(this.sessionDataCache.sessionDifferentiator)}return fn},e.prototype.isPrismModeEnabled=function(){var t=this.getMetaTagContent().prismModeEnabled;return typeof t=="boolean"?t:!!this.sessionDataCache.prismModeEnabled},e.prototype.findWindowWithTelemetryBroker=function(){for(var t=window;;){if(t[ln.TELEMETRY_BROKER_PROPERTY_NAME])return t;if(t===t.parent)return;t=t.parent}},e}();V.DataParser=gn;Object.defineProperty(he,"__esModule",{value:!0});he.CookieObserver=void 0;var yn=V,mn=5e3,En=function(){function e(t,n,r){n===void 0&&(n=mn),this.cookieName=t,this.listeners=[],this.dataParser=r??yn.DataParser.getInstance(),this.lastSeenCookieValue=this.dataParser.parseCookie(t),setInterval(this.poll.bind(this),n)}return e.prototype.addChangeListener=function(t){this.listeners.push(t)},e.prototype.poll=function(){var t=this.dataParser.parseCookie(this.cookieName);this.lastSeenCookieValue!==t&&this.getCookieListener().forEach(function(n){return n()}),this.lastSeenCookieValue=t},e.prototype.getCookieListener=function(){return this.listeners},e}();he.CookieObserver=En;var ee={},ve={};Object.defineProperty(ve,"__esModule",{value:!0});ve.BrokerWrapper=void 0;var Tn=Q,wn=function(){function e(t){this.telemetryBroker=t[Tn.TELEMETRY_BROKER_PROPERTY_NAME]}return e.prototype.register=function(t){return this.telemetryBroker.register(t)},e.prototype.addEvent=function(t){this.telemetryBroker.addEvent(t)},e.prototype.dangerouslyFlushEvents=function(){this.telemetryBroker.dangerouslyFlushEvents()},e}();ve.BrokerWrapper=wn;var ge={};Object.defineProperty(ge,"__esModule",{value:!0});ge.PACKAGE_VERSION=void 0;ge.PACKAGE_VERSION="2.0.36779.0#2f971726";var w=v&&v.__assign||function(){return w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},w.apply(this,arguments)};Object.defineProperty(ee,"__esModule",{value:!0});ee.ScheduledEventTracker=void 0;var Ge=V,_n=ve,k=ge,kn=_,bn=function(){function e(t,n){this.props=t;var r=function(){var a=n.tokensForPublicEvents;if(a!==void 0)return a;var o=n.parentToken;if(o!==void 0)return[o]}();this.id=this.props.broker.register({source:"weblib-v2",telemetryToken:n.token,telemetryTokensForPublicEvents:r})}return e.getInstance=function(t){var n=t??{token:Ge.DataParser.getInstance().getTelemetryMetaTagContent().telemetryToken},r=Ge.DataParser.getInstance().getTelemetryBrokerWindow();if(r===void 0)throw new kn.TelemetryBrokerNotAvailableError("Telemetry broker not found");return new e({broker:new _n.BrokerWrapper(r)},n)},e.prototype.addEvent=function(t,n){var r={type:"log",content:t,version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:r},n))},e.prototype.addError=function(t,n,r){var a={type:"error",content:w({error:t},n),version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addFatalError=function(t,n,r,a){var o={type:"fatal-error",content:w({error:t},n),fatalErrorMetadata:r,version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:o},a))},e.prototype.addAwsSdkEvent=function(t,n){var r={type:"aws-sdk-metric",awsSdkMetric:t,content:{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:r},n))},e.prototype.addFmsEvaluationEvent=function(t,n,r){var a={type:"fms-evaluation",fmsEvaluation:t,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addAwsArachnidQueryEvent=function(t,n,r){var a={type:"aws-arachnid-query",awsArachnidQuery:t,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addJanusApiEvent=function(t,n,r){var a={type:"janus-api",janusApi:t,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addJanusCredentialEvent=function(t,n,r){var a={type:"janus-credential",janusCredential:t,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addLotusCspEvent=function(t,n,r){var a={type:"lotus-csp",lotusCsp:t,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addLotusIsolatedIFrameEvent=function(t,n,r){var a={type:"lotus-isolated-iframe",lotusIsolatedIFrame:t,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addLotusImportPackageEvent=function(t,n,r){var a={type:"lotus-import-package",lotusImportPackage:t.lotusImportPackage,lotusMetadata:t.lotusMetadata,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addCloudEditorEvent=function(t,n,r){var a={type:"cloud-editor",cloudEditor:t,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addCloudEditorLspEvent=function(t,n,r){var a={type:"cloud-editor-lsp",cloudEditorLsp:t,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addPapiProxyEvent=function(t,n,r){var a={type:"papi-proxy",papiProxy:t,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addPapiCredentialEvent=function(t,n,r){var a={type:"papi-credential",papiCredential:t,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.addBootstrapEvent=function(t,n,r){var a={type:"tb-bootstrap",tbBootstrap:t,content:n??{},version:k.PACKAGE_VERSION,timestamp:new Date};this.props.broker.addEvent(w({tenantId:this.id,event:a},r))},e.prototype.dangerouslyFlushEvents=function(){this.props.broker.dangerouslyFlushEvents()},e}();ee.ScheduledEventTracker=bn;var _e=v&&v.__assign||function(){return _e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},_e.apply(this,arguments)},Sn=v&&v.__awaiter||function(e,t,n,r){function a(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(u){try{s(r.next(u))}catch(p){i(p)}}function d(u){try{s(r.throw(u))}catch(p){i(p)}}function s(u){u.done?o(u.value):a(u.value).then(c,d)}s((r=r.apply(e,t||[])).next())})},Cn=v&&v.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,a,o,i;return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(s){return function(u){return d([s,u])}}function d(s){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,a&&(o=s[0]&2?a.return:s[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,s[1])).done)return o;switch(a=0,o&&(s=[s[0]&2,o.value]),s[0]){case 0:case 1:o=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,a=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1],o=s;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(s);break}o[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(u){s=[6,u],a=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(pe,"__esModule",{value:!0});pe.BrowserCredentials=void 0;var Mn=vt,Rn=he,J=_,In=V,An=ee,M,Dn=function(){function e(t,n,r,a,o){var i=this;this.isLoggedOut=!1,this.loggedOutMessage="User Logged Out",this.dataParser=o,this.credentialsConfig=t,this.eventTracker=r,this.httpClient=n,this.cookieObserver=a,this.addLogoutListener(function(){i.isLoggedOut=!0,M&&(M.accessKeyId="",M.secretAccessKey="",M.sessionToken="",M.expiration=new Date(0))})}return e.getInstance=function(){if(!this.browserCredentialsInstance){var t=In.DataParser.getInstance(),n=void 0;try{n=An.ScheduledEventTracker.getInstance()}catch(o){console.error("BrowserCredentials cannot instantiate ScheduledEventTracker",o)}var r=t.getCredentialsConfig(),a=new Mn.HttpClient;this.browserCredentialsInstance=new e(r,a,n,new Rn.CookieObserver(t.getLogoutDetectionCookieName()),t)}return this.browserCredentialsInstance},e.prototype.getCredentials=function(){return Sn(this,void 0,void 0,function(){var t,n,r,a,o;return Cn(this,function(i){switch(i.label){case 0:if(this.isLoggedOut)throw new J.RefreshCredentialError(this.loggedOutMessage);if(M?.expiration&&new Date(M.expiration).getTime()-Date.now()>3e5)return[2,M];t={url:this.credentialsConfig.browserCredsFullPath,method:"POST",headers:{"x-csrf-token":this.credentialsConfig.csrfToken},timeout:5e3,timeoutIncreasePerRetry:5e3,maxRetries:4},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.httpClient.call(t)];case 2:return n=i.sent(),[3,4];case 3:throw r=i.sent(),this.emitClientErrorEvent(r),new J.RefreshCredentialError("Fail to request credentials",r);case 4:if(this.emitClientResponseEvent(n),n.finalHttpStatusCode>=200&&n.finalHttpStatusCode<300)this.validate(n.data);else{if([401,403].includes(n.finalHttpStatusCode))throw a=n.finalHttpStatusCode===401?"Unauthorized":"InvalidCsrfTokenError",this.dataParser.triggerLoggedOutDialog(),this.cookieObserver.getCookieListener().forEach(function(c){return c()}),this.loggedOutMessage="".concat(a,": Session is invalid"),new J.RefreshCredentialError(this.loggedOutMessage);o=void 0;try{o=JSON.parse(n.data.toString()).error}catch{o="HTTP status code ".concat(n.finalHttpStatusCode)}throw new J.RefreshCredentialError(o)}return M=n.data,[2,M]}})})},e.prototype.validate=function(t){for(var n=0,r=["accessKeyId","secretAccessKey","sessionToken"];n<r.length;n++){var a=r[n];if(!t[a])throw new J.InvalidCredentialsError('Invalid credentials, missing property: "'.concat(a,'"'))}},e.prototype.addLogoutListener=function(t){this.cookieObserver.addChangeListener(t)},e.prototype.emitClientErrorEvent=function(t){var n,r={attemptCount:t.metadata.retries,latencyMillseconds:t.metadata.latencyMillseconds,maxRetriesExceeded:t.metadata.maxRetriesExceeded,startTimestamp:t.metadata.startTimestamp,finalSdkException:t.metadata.code,finalSdkExceptionMessage:t.message,operation:"RefreshCredentials",service:"TangerineBox",region:""};(n=this.eventTracker)===null||n===void 0||n.addAwsSdkEvent(r)},e.prototype.emitClientResponseEvent=function(t){var n,r={attemptCount:t.retries,finalHttpStatusCode:t.finalHttpStatusCode,latencyMillseconds:t.latencyMillseconds,maxRetriesExceeded:t.maxRetriesExceeded,startTimestamp:t.startTimestamp,operation:"RefreshCredentials",service:"TangerineBox",region:""};t.finalHttpStatusCode>=400&&(r=_e({finalSdkException:"RequestFailed",finalSdkExceptionMessage:"Request failed with status code ".concat(t.finalHttpStatusCode),finalHttpStatusCode:t.finalHttpStatusCode},r)),(n=this.eventTracker)===null||n===void 0||n.addAwsSdkEvent(r)},e}();pe.BrowserCredentials=Dn;var ye={},A=v&&v.__awaiter||function(e,t,n,r){function a(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(u){try{s(r.next(u))}catch(p){i(p)}}function d(u){try{s(r.throw(u))}catch(p){i(p)}}function s(u){u.done?o(u.value):a(u.value).then(c,d)}s((r=r.apply(e,t||[])).next())})},D=v&&v.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,a,o,i;return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(s){return function(u){return d([s,u])}}function d(s){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,a&&(o=s[0]&2?a.return:s[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,s[1])).done)return o;switch(a=0,o&&(s=[s[0]&2,o.value]),s[0]){case 0:case 1:o=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,a=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1],o=s;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(s);break}o[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(u){s=[6,u],a=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(ye,"__esModule",{value:!0});ye.MetaDataProvider=void 0;var On=V,Pn=function(){function e(t){this.dataParser=t}return e.getInstance=function(){return this.metaDataProviderInstance||(this.metaDataProviderInstance=new e(On.DataParser.getInstance())),this.metaDataProviderInstance},e.prototype.getCdnUrl=function(t){return/^(http|https|ws|wss):\/\//.test(t)?t:"".concat(this.dataParser.getMetaTagContent().cdn).concat(t)},e.prototype.getCustomContext=function(t){return this.dataParser.getMetaTagContent().custom[t]},e.prototype.getAssetUrl=function(t,n){var r=this.getCustomContext(t)+"/".concat(n);return this.getCdnUrl(r)},e.prototype.getConsoleTelemetryToken=function(){return this.dataParser.getTelemetryMetaTagContent().telemetryToken},e.prototype.getSessionARN=function(){return A(this,void 0,void 0,function(){return D(this,function(t){return[2,this.dataParser.getSessionDataValue("sessionARN")]})})},e.prototype.getAccountId=function(){return A(this,void 0,void 0,function(){return D(this,function(t){return[2,this.dataParser.getSessionDataValue("accountId")]})})},e.prototype.getIdentityToken=function(){return A(this,void 0,void 0,function(){return D(this,function(t){return[2,this.dataParser.getSessionDataValue("identityToken")]})})},e.prototype.getSessionId=function(){return A(this,void 0,void 0,function(){return D(this,function(t){return[2,this.dataParser.getSessionDataValue("sessionId")]})})},e.prototype.getInfrastructureRegion=function(){return A(this,void 0,void 0,function(){return D(this,function(t){return[2,this.dataParser.getSessionDataValue("infrastructureRegion")]})})},e.prototype.getVpc=function(){return A(this,void 0,void 0,function(){return D(this,function(t){return[2,this.dataParser.getSessionDataValue("vpc")]})})},e.prototype.getAccountAlias=function(){return A(this,void 0,void 0,function(){return D(this,function(t){return[2,this.dataParser.getSessionDataValue("accountAlias")]})})},e.prototype.getDisplayName=function(){return A(this,void 0,void 0,function(){return D(this,function(t){return[2,this.dataParser.getSessionDataValue("displayName")]})})},e.prototype.getSessionDifferentiator=function(){return A(this,void 0,void 0,function(){return D(this,function(t){return[2,this.dataParser.getSessionDataValue("sessionDifferentiator")]})})},e.prototype.isMultiSessionEnabled=function(){return A(this,void 0,void 0,function(){return D(this,function(t){switch(t.label){case 0:return[4,this.dataParser.getSessionDataValue("prismModeEnabled")];case 1:return[2,!!t.sent()]}})})},e}();ye.MetaDataProvider=Pn;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MetaDataProvider=e.ScheduledEventTracker=e.BrowserCredentials=void 0;var t=pe;Object.defineProperty(e,"BrowserCredentials",{enumerable:!0,get:function(){return t.BrowserCredentials}});var n=ee;Object.defineProperty(e,"ScheduledEventTracker",{enumerable:!0,get:function(){return n.ScheduledEventTracker}});var r=ye;Object.defineProperty(e,"MetaDataProvider",{enumerable:!0,get:function(){return r.MetaDataProvider}})})(L);Object.defineProperty(G,"__esModule",{value:!0});G.NoOpTrackerForLibrary=G.TangerineBoxEventTrackerForLibrary=void 0;var xn=Z,Bn=L,Ln=function(){function e(t){this.scheduledEventTracker=t}return e.getInstance=function(t){try{return new e(Bn.ScheduledEventTracker.getInstance(t))}catch{return console.warn(xn.TELEMETRY_CONFIG_MISSING_MSG),new gt}},e.prototype.addEvent=function(t){this.scheduledEventTracker.addEvent(t,{publicEvent:!1})},e.prototype.addError=function(t,n,r){this.scheduledEventTracker.addError(t,n,r)},e.prototype.addFatalError=function(t,n,r,a){this.scheduledEventTracker.addFatalError(t,n,r,a)},e.prototype.addFmsEvaluationEvent=function(t,n,r){this.scheduledEventTracker.addFmsEvaluationEvent(t,n,r)},e.prototype.addAwsArachnidQueryEvent=function(t,n,r){this.scheduledEventTracker.addAwsArachnidQueryEvent(t,n,r)},e.prototype.addJanusApiEvent=function(t,n,r){this.scheduledEventTracker.addJanusApiEvent(t,n,r)},e.prototype.addJanusCredentialEvent=function(t,n,r){this.scheduledEventTracker.addJanusCredentialEvent(t,n,r)},e.prototype.addLotusCspEvent=function(t,n,r){this.scheduledEventTracker.addLotusCspEvent(t,n,r)},e.prototype.addLotusIsolatedIFrameEvent=function(t,n,r){this.scheduledEventTracker.addLotusIsolatedIFrameEvent(t,n,r)},e.prototype.addLotusImportPackageEvent=function(t,n,r){this.scheduledEventTracker.addLotusImportPackageEvent(t,n,r)},e.prototype.addCloudEditorEvent=function(t,n,r){this.scheduledEventTracker.addCloudEditorEvent(t,n,r)},e.prototype.addCloudEditorLspEvent=function(t,n,r){this.scheduledEventTracker.addCloudEditorLspEvent(t,n,r)},e.prototype.addPapiProxyEvent=function(t,n,r){this.scheduledEventTracker.addPapiProxyEvent(t,n,r)},e.prototype.addPapiCredentialEvent=function(t,n,r){this.scheduledEventTracker.addPapiCredentialEvent(t,n,r)},e.prototype.addBootstrapEvent=function(t,n,r){this.scheduledEventTracker.addBootstrapEvent(t,n,r)},e}();G.TangerineBoxEventTrackerForLibrary=Ln;var gt=function(){function e(){}return e.prototype.addEvent=function(t,n){},e.prototype.addError=function(t,n,r){},e.prototype.addFatalError=function(t,n,r,a){},e.prototype.addFmsEvaluationEvent=function(t,n,r){},e.prototype.addAwsArachnidQueryEvent=function(t,n,r){},e.prototype.addJanusApiEvent=function(t,n,r){},e.prototype.addJanusCredentialEvent=function(t,n,r){},e.prototype.addLotusCspEvent=function(t,n,r){},e.prototype.addLotusIsolatedIFrameEvent=function(t,n,r){},e.prototype.addLotusImportPackageEvent=function(t,n,r){},e.prototype.addCloudEditorEvent=function(t,n,r){},e.prototype.addCloudEditorLspEvent=function(t,n,r){},e.prototype.addPapiCredentialEvent=function(t,n,r){},e.prototype.addPapiProxyEvent=function(t,n,r){},e.prototype.addBootstrapEvent=function(t,n,r){},e}();G.NoOpTrackerForLibrary=gt;var K={};Object.defineProperty(K,"__esModule",{value:!0});K.NoOpTrackerForWidget=K.TangerineBoxEventTrackerForWidget=void 0;var Nn=Z,Fn=L,Un=function(){function e(t){this.scheduledEventTracker=t}return e.getInstance=function(t){try{return new e(Fn.ScheduledEventTracker.getInstance(t))}catch{return console.warn(Nn.TELEMETRY_CONFIG_MISSING_MSG),new yt}},e.prototype.addEvent=function(t,n){this.scheduledEventTracker.addEvent(t,n)},e.prototype.addError=function(t,n,r){this.scheduledEventTracker.addError(t,n,r)},e.prototype.addFatalError=function(t,n,r,a){this.scheduledEventTracker.addFatalError(t,n,r,a)},e}();K.TangerineBoxEventTrackerForWidget=Un;var yt=function(){function e(){}return e.prototype.addEvent=function(t,n){},e.prototype.addError=function(t,n,r){},e.prototype.addFatalError=function(t,n,r,a){},e}();K.NoOpTrackerForWidget=yt;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TangerineBoxEventTrackerForWidget=e.TangerineBoxEventTrackerForLibrary=void 0;var t=G;Object.defineProperty(e,"TangerineBoxEventTrackerForLibrary",{enumerable:!0,get:function(){return t.TangerineBoxEventTrackerForLibrary}});var n=K;Object.defineProperty(e,"TangerineBoxEventTrackerForWidget",{enumerable:!0,get:function(){return n.TangerineBoxEventTrackerForWidget}})})(ht);const Wn="DEFAULT_WIDGET_2023_04_19";class $n{static async createTenantToken(t){const{servicePrincipal:n,telemetrySinkName:r}=this.generateTangerineBoxTelemetryBoxTokenResources(t),a=`${n}-${r}-${Wn}`,o=await this.hash(a);return`${this.getPrefix()}${o}`}static getPrefix(){return"v1/"}static generateTangerineBoxTelemetryBoxTokenResources(t){const n=t.replace("@amzn/","").toLowerCase();return{servicePrincipal:`prod.telemetry.${n}.aws.internal`,telemetrySinkName:n}}static async hash(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(r)).map(i=>i.toString(16).padStart(2,"0")).join("")}}const Vn="v1/38ab1eac59303aa74f95dc67b661869747f928f1e58cde3ff57f15806b4db643";class jn{startTime;startTimer(){return this.startTime=performance.now(),this.startTime}getElapsedTime=()=>performance.now()-this.startTime;async getTBTEventTracker({packageName:t,telemetryToken:n,parentTelemetryTokens:r=[]}){const o=[n||await $n.createTenantToken(t),...r];return ht.TangerineBoxEventTrackerForLibrary.getInstance({token:Vn,tokensForPublicEvents:o})}}const Hn={"us-isof-south-1":"aws-iso-f","us-iso-west-1":"aws-iso","cn-north-1":"aws-cn","us-iso-east-1":"aws-iso","us-isob-west-1":"aws-iso-b","us-isob-east-1":"aws-iso-b","us-isof-east-1":"aws-iso-f","eu-isoe-west-1":"aws-iso-e","us-gov-east-1":"aws-us-gov","us-gov-west-1":"aws-us-gov","cn-northwest-1":"aws-cn"};var O;(function(e){e.AWS="aws",e.AWSCN="aws-cn",e.AWSUSGOV="aws-us-gov",e.AWSISO="aws-iso",e.AWSISOB="aws-iso-b",e.AWSISOE="aws-iso-e",e.AWSISOF="aws-iso-f"})(O||(O={}));const j={[O.AWS]:{rootDomain:"amazon.com",defaultRegion:"us-east-1",regionlessSubDomain:"console.aws",globalSubDomain:"global.console.aws"},[O.AWSCN]:{rootDomain:"amazonaws.cn",defaultRegion:"cn-north-1",regionlessSubDomain:"console"},[O.AWSUSGOV]:{rootDomain:"amazonaws-us-gov.com",defaultRegion:"us-gov-west-1",regionlessSubDomain:"console"},[O.AWSISO]:{rootDomain:"c2shome.ic.gov",defaultRegion:"us-iso-east-1",regionlessSubDomain:"console"},[O.AWSISOB]:{rootDomain:"sc2shome.sgov.gov",defaultRegion:"us-isob-east-1",regionlessSubDomain:"console"},[O.AWSISOE]:{rootDomain:"csphome.adc-e.uk",defaultRegion:"eu-isoe-west-1",regionlessSubDomain:"console"},[O.AWSISOF]:{rootDomain:"csphome.hci.ic.gov",defaultRegion:"us-isof-south-1",regionlessSubDomain:"console"}},Ke="awsc-mezz-region";function Gn(){const e=document.getElementById(Ke);let t=e?.getAttribute("content");if(!e)try{t=window.top.document.getElementById(Ke)?.getAttribute("content")}catch{}if(t)return t;console.warn("Lotus: awsc-mezz-region element is not available. Falling back to default region");for(const n of Object.values(j))if(window.location.host.indexOf(n.rootDomain)>=0)return n.defaultRegion;return"us-east-1"}function Kn(e){const t=Hn[e]||O.AWS;return j[t].globalSubDomain?`${j[t].globalSubDomain}.${j[t].rootDomain}`:`${e}.${j[t].regionlessSubDomain}.${j[t].rootDomain}`}const Yn=e=>{const t=document.cookie.length>0?e.split(";"):[],n=t.length,r={};for(let a=0;a<n;a++){const o=t[a].split("="),i=o[0].trim(),c=o[1];r[i]={raw:c}}return{getCookie:a=>{const o=r[a];if(!o)return null;let i=o.unescaped;if(i===void 0){const c=o.raw;i=o.unescaped=unescape(c.trim())}return i}}},mt=e=>{const t=document.cookie;return Yn(t).getCookie(e)};let Ye={};const qe=e=>{let t=Ye[e];return t===void 0&&(t=Ye[e]=mt(e)||null),t};function Et(e){try{const t=`meta[name='${e}']`;let n=document.querySelector(t);return n||(n=window.top?.document.querySelector(t)),n?.content}catch{return}}function qn(e){const t=Et(e);if(t)return JSON.parse(t);throw new Error(`failed to parse meta tag ${e}`)}const zn="awsc-session-data",Jn="awsc-mezz-region",Xn={accountId:void 0,sessionARN:void 0,sessionId:void 0,sessionDifferentiator:void 0,identityToken:void 0,accountAlias:void 0,displayName:void 0,infrastructureRegion:void 0,vpc:{vpcId:void 0,vpceId:void 0},prismModeEnabled:void 0};class U{static sessionDataParserInstance;sessionDataCache;constructor(){this.sessionDataCache=this.parseSessionDataMetaTag()}static getInstance(){return this.sessionDataParserInstance||(this.sessionDataParserInstance=new U),this.sessionDataParserInstance}static validateSessionData(t){const n=[];t?.sessionARN||n.push("sessionARN"),t?.identityToken||n.push("identityToken"),t?.accountId||n.push("accountId"),t?.infrastructureRegion||n.push("infrastructureRegion"),t?.sessionDifferentiator||n.push("sessionDifferentiator"),n.length&&U.throwErrorOnFields(n)}static throwErrorOnFields(t){const n=JSON.stringify({missingFieldsInSessionData:t});throw new Error(n)}validateSessionData(){U.validateSessionData(this.sessionDataCache)}getSessionData(){return this.sessionDataCache?this.sessionDataCache:this.parseSessionDataMetaTag()}parseSessionDataMetaTag(){let t,n;try{t=qn(zn),te.isValidSessionData(t)||(n=this.parseSessionDataLegacy())}catch{try{n=this.parseSessionDataLegacy()}catch{}}return{...Xn,...n,...t}}decryptUserInfoSignedCookie(t){try{const n=t.split(".")[1],r=atob(n);return JSON.parse(r)}catch{return console.warn("Unable to decrypt userInfoSigned cookie"),""}}getSessionDataFromUserInfoCookie(){const t=qe("aws-userInfo"),n=qe("aws-userInfo-signed"),r=/arn:([^:]*):([^:]*):([^:]*):([^:]*):([^:]*)/;if(t&&n){const{arn:a,alias:o,username:i}=JSON.parse(t),c=r.exec(a);return{accountId:c?c[4]:"",sessionARN:a,accountAlias:o,displayName:i,identityToken:n,sessionDifferentiator:this.decryptUserInfoSignedCookie(n)?.sessionDiff??""}}throw new Error("No userinfo or userinfo-signed cookie found!")}getInfrastructureRegionFromMezzanineMetaTag(){return Et(Jn)}parseSessionDataLegacy(){try{return{...this.getSessionDataFromUserInfoCookie(),infrastructureRegion:this.getInfrastructureRegionFromMezzanineMetaTag()}}catch(t){throw console.warn("Unable to parse the data using legacy methods"),t}}}const ze=()=>{const t=mt("aws-prism-opt-in")||"";return!!t&&t==="true"};class te{static sessionDataProviderInstance;dataParser;constructor(t){this.dataParser=t}static isValidSessionData=t=>{try{return U.validateSessionData(t),!0}catch{return!1}};static validateSessionData=t=>(U.validateSessionData(t),!0);static getInstance(){return this.sessionDataProviderInstance||(this.sessionDataProviderInstance=new te(U.getInstance())),this.sessionDataProviderInstance}async getSessionARN(){return this.dataParser.getSessionData().sessionARN||""}async getAccountId(){return this.dataParser.getSessionData().accountId||""}async getIdentityToken(){return this.dataParser.getSessionData().identityToken||""}async getSessionId(){return this.dataParser.getSessionData().sessionId}async getInfrastructureRegion(){return this.dataParser.getSessionData().infrastructureRegion||""}async getVpc(){const t=this.dataParser.getSessionData();let n;return t&&(n=t.vpc),n}async getAccountAlias(){return this.dataParser.getSessionData().accountAlias}async getDisplayName(){return this.dataParser.getSessionData().displayName}async getSessionDifferentiator(){return this.dataParser.getSessionData().sessionDifferentiator}async getSessionData(){const t=this.dataParser.getSessionData();return t.prismModeEnabled||(t.prismModeEnabled=ze()),t}async isMultiSessionEnabled(){const t=this.dataParser.getSessionData();return t.prismModeEnabled?t.prismModeEnabled:ze()}}class Zn extends jn{async logRequest(t){await this.emitTBTMetric(t)}async emitTBTMetric({packageName:t,majorVersion:n,elapsedTime:r,statusCode:a,error:o,responseHeaders:i,versionId:c,telemetryToken:d,parentTelemetryTokens:s}){(await this.getTBTEventTracker({packageName:t,telemetryToken:d,parentTelemetryTokens:s})).addLotusImportPackageEvent({lotusMetadata:{packageName:t,majorVersion:n,versionId:c,latency:r,statusCode:a,requestId:i?i.apiGatewayRequestId:void 0,errorDetails:o?{code:o.name,message:o.message}:void 0}},void 0,{publicEvent:!0})}}const Qn=(e,t)=>{const n=Math.random()*2**e*t;return new Promise(r=>setTimeout(r,n))};var Je;(function(e){e.PROD="prod",e.PRODISH="prodish"})(Je||(Je={}));var ke;(function(e){e.AnyAccount="ANY_ACCOUNT",e.AllowedAccounts="ALLOWED_ACCOUNTS"})(ke||(ke={}));class x extends Error{status;constructor({name:t,message:n,cause:r,status:a}){super(n,r),this.status=a,this.name=t}}var R;(function(e){e.NetworkError="NetworkError",e.InvalidParametersError="InvalidParametersError",e.InvalidResponseError="InvalidResponseError",e.ConsoleProxyWafError="ConsoleProxyWAFError"})(R||(R={}));const er="/lotus/metadata",tr=e=>Object.fromEntries(document.cookie.split(";").map(n=>n.split("=").map(r=>decodeURIComponent(r.trim()))))[e],nr=e=>!!(e?.basePath&&e?.versionId&&(e?.metadata?.module||e?.metadata?.assets?.length)),rr=()=>{const t=new URLSearchParams(window.location.search).get(we.ConsoleRegion);if(t)return t},or=1e4,ar=5e3,sr=4,ir=100,cr=[400,401,403,404,413,415],ur="X-Amz-Apigw-Id",dr="Apigw-Requestid",lr="x-lotus-region",fr=async(e,t,n)=>{const r=new AbortController;setTimeout(()=>{r.abort()},n);const a={method:"GET",headers:t,credentials:"omit",signal:r.signal};try{const o=await fetch(e,a);return{status:o.status,body:await o.text(),responseHeaders:{apiGatewayRequestId:o.headers.get(dr)||o.headers.get(ur)||"null",lotusRegion:o.headers.get(lr)||"null"}}}catch(o){throw o.name==="AbortError"?new x({name:R.NetworkError,message:"Timed out",cause:o}):new x({name:R.NetworkError,message:`Fetch error: ${o.message}`,cause:o})}},Xe=async(e,t,n)=>{const r=tr("metrics-req-cat")==="canary",a=sr,o=ir,i=r?ar:or;let c=new Error("Error"),d;for(let s=0;s<a;s+=1){try{if(d=await fr(e,t,i),d.status===200||cr.includes(d.status))break}catch(u){if(c=u,u.name!==R.NetworkError)break}await Qn(s,o)}if(d!==void 0)return d;throw c};class pr extends Error{message;originalError;constructor(t,n){super(t),this.message=t,this.originalError=n,this.name=this.constructor.name,n&&(this.stack+=`
Caused by: ${n.stack}`)}}class Ze extends pr{}function hr(e){const t=document.querySelector(`meta[name='${e}']`);if(t)return t.content}function vr(){const e=hr("tb-data");if(!e)throw new Ze("TangerineBox meta tag not found");try{return JSON.parse(e)}catch(t){throw new Ze("Unable to parse TangerineBox meta tag contents",t instanceof Error?t:new Error(String(t)))}}let ae;class gr{constructor(t){t&&(ae=t)}getCdnUrl(t){return/^(http|https|ws|wss):\/\//.test(t)?t:`${this.getMetaTagContent().cdn}${t}`}getMetaTagContent(){return ae||(ae=vr()),ae}}function yr({status:e,parsedBody:t}){if(e<200||e>=300){const{code:r,message:a}=t;throw new x({name:r||R.InvalidResponseError,message:a,status:e})}if(!nr(t))throw new x({name:R.InvalidResponseError,message:"Invalid metadata structure in response body",status:e});const n=new URL(t.basePath);try{const a=new gr().getCdnUrl(""),o=new URL(a);n.hostname=o.hostname,t.basePath=n.toString()}catch{}return t}function Qe({status:e,body:t}){let n;try{n=JSON.parse(t)}catch(r){throw e===405?new x({name:R.ConsoleProxyWafError,message:`Received 405 from Console Proxy WAF: ${t}`}):new x({name:R.InvalidResponseError,message:`Response body is not valid JSON: ${t}`,cause:r,status:e})}return n}const mr=async({packageName:e,majorVersion:t,host:n,aliasName:r,accessType:a,consoleRegion:o,onComplete:i,cacheInvalidator:c,telemetryToken:d,parentTelemetryTokens:s})=>{const u=performance.now(),p=i||(h=>{new Zn().logRequest(h)});let l;try{if(!e||!t)throw new x({name:R.InvalidParametersError,message:"Missing package name or majorVersion."});const h=te.getInstance(),g=await h.getAccountId(),m=o||await h.getInfrastructureRegion()||rr()||Gn();if(!g||!m)throw new x({name:R.InvalidParametersError,message:"Missing accountId or console region."});let f={};const y=new URLSearchParams({[P.PackageName]:e,[P.MajorVersion]:t,[P.AccountId]:g,[P.Region]:m,[P.SucceedOnRetry]:"true"});r&&y.append(P.AliasName,r),c&&y.append(P.CacheInvalidator,c);const T=`https://${n||Kn(m)}${er}?${y.toString()}`,b=new x({name:R.InvalidParametersError,message:"Missing identity token."});if(a===ke.AllowedAccounts){const N=await h.getIdentityToken();if(!N)throw b;f={"x-userinfo-signed":N}}l=await Xe(T,f);let S=Qe(l);if(S.retryWithIdentityToken){const N=await h.getIdentityToken();if(!N)throw b;f={"x-userinfo-signed":N},l=await Xe(T,f),S=Qe(l)}const E=yr({status:l.status,parsedBody:S});return p({packageName:e,majorVersion:t,elapsedTime:performance.now()-u,statusCode:200,responseHeaders:l.responseHeaders,versionId:E.versionId,telemetryToken:d,parentTelemetryTokens:s}),E}catch(h){throw p({packageName:e,majorVersion:t,elapsedTime:performance.now()-u,error:h,statusCode:l?l.status:void 0,responseHeaders:l?l.responseHeaders:void 0,versionId:void 0,telemetryToken:d,parentTelemetryTokens:s}),h}};var ie;(function(e){e.DefaultConsole20230419="DEFAULT_CONSOLE_2023_04_19",e.DefaultWidget20230419="DEFAULT_WIDGET_2023_04_19",e.DefaultLibrary20231023="DEFAULT_LIBRARY_2023_10_23"})(ie||(ie={}));const Er="v1/38ab1eac59303aa74f95dc67b661869747f928f1e58cde3ff57f15806b4db643",Tr="v0/invalid-token-",wr="awt-observe-internal-event-tracker";var ce;(function(e){e.DEFAULT_2023_05_15="DEFAULT_2023_05_15"})(ce||(ce={}));class _r{async createTenantToken(t,n,r){const a=`${t}-${n}-${r}`,o=await this.hash(a);return`${this.getPrefix()}${o}`}getPrefix(){return"v1/"}async hash(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n);return[...new Uint8Array(r)].map(i=>i.toString(16).padStart(2,"0")).join("")}}class kr{static getCreator(t){switch(t){case ce.DEFAULT_2023_05_15:return new _r;default:throw new Error("Unsupported token version")}}}var be;(function(e){e.Api="api",e.Error="error",e.Load="load",e.Render="render",e.AwsSdk="aws-sdk",e.Log="log"})(be||(be={}));be.Error;var et;(function(e){e.AwtSdk="awt-sdk",e.Library="library",e.LotusPackage="lotus-package",e.Module="module",e.ModulesRuntime="modules-runtime",e.Other="other",e.UnifiedConsole="unified-console",e.UnifiedConsoleModule="unified-console-module",e.UnifiedConsolePlatformModule="unified-console-platform-module"})(et||(et={}));var tt;(function(e){e.AttemptCount="attemptCount",e.FinalHttpStatusCode="finalHttpStatusCode",e.Latency="latency",e.MaxRetriesExceeded="maxRetriesExceeded",e.Retries="retries",e.Errors="errors",e.FatalErrors="fatalErrors",e.UnhandledErrors="unhandledErrors"})(tt||(tt={}));var nt;(function(e){e.Alpha="alpha",e.Beta="beta",e.Gamma="gamma",e.Test="test",e.Dev="dev",e.Integ="integ",e.NonProd="nonprod",e.PreProd="preprod",e.Prod="prod"})(nt||(nt={}));var C;(function(e){e[e.All=1]="All",e[e.Trace=2]="Trace",e[e.Debug=3]="Debug",e[e.Info=4]="Info",e[e.Warn=5]="Warn",e[e.Error=6]="Error",e[e.Off=7]="Off"})(C||(C={}));var rt;(function(e){e.InvalidEvent="InvalidEvent"})(rt||(rt={}));var ue;(function(e){e.EventTrackerName="eventTrackerName",e.LogLevel="logLevel"})(ue||(ue={}));const br={emitEvent:()=>{},emitAwsSdkEvents:()=>{},getEventTrackerConfig:()=>({}),setEventTrackerConfig:()=>{}},Tt="awt-observe-do-not-use",Sr=["dashboard-widget-appRegistryApplications"],Cr=({identifier:e})=>{const t=e.replace("@amzn/",""),n=t.toLowerCase();return/^[\w-]{1,100}$/.test(n)?Sr.includes(t)?{succeeded:!0,servicePrincipal:`prod.telemetry.${t}.aws.internal`,telemetrySinkName:t}:{succeeded:!0,servicePrincipal:`prod.telemetry.${n}.aws.internal`,telemetrySinkName:n}:{succeeded:!1,code:"ParseError",message:`Unable to parse telemetry sink name from "${e}". Identifier (excluding "@amzn/") is expected to be hyphenated alphanumeric and 100 characters or less.`}},wt=()=>Object.freeze(br),Mr=e=>typeof e=="object"&&typeof e.getEventTracker=="function",Rr=()=>{let e=window;for(;;){try{if(e[Symbol.for(Tt)])return e}catch{return}if(e===e.parent)return;e=e.parent}},Ir=()=>{const e=Rr();if(!e)return;const t=e[Symbol.for(Tt)];return Mr(t)?t:void 0},Ar=e=>{if(!e)return;const t=Number(e);if(t&&t>=C.All&&t<=C.Off)return t;switch(e.toLowerCase()){case"all":return C.All;case"trace":return C.Trace;case"debug":return C.Debug;case"info":return C.Info;case"warn":return C.Warn;case"error":return C.Error;case"off":return C.Off;default:return}},Dr=()=>{const e=new URL(globalThis?.location?.href),t=new URLSearchParams(e?.searchParams);return{eventTrackerName:t.get(ue.EventTrackerName)??void 0,logLevel:Ar(t.get(ue.LogLevel))}},Or=({eventTrackerName:e,eventTrackerConfig:t,overrides:n,eventTrackingSystem:r})=>{if(n.eventTrackerName&&!e.toLowerCase().includes(n.eventTrackerName.toLowerCase()))return wt();const a={...t,logLevel:n.logLevel??t?.logLevel};return r.getEventTracker(e,a)},de=(e,t)=>{const n=Ir();if(!n)return wt();if(n.isProd)return n.getEventTracker(e,t);const r=Dr();return Or({eventTrackerName:e,eventTrackerConfig:t,overrides:r,eventTrackingSystem:n})};var Pr={},B={},Y;(function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"})(Y||(Y={}));const Se=3,xr=Y.STANDARD,Br=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],Lr=e=>e.$metadata?.httpStatusCode===429||Br.includes(e.name)||e.$retryable?.throttling==!0;class _t{constructor(t){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=t?.beta??.7,this.minCapacity=t?.minCapacity??1,this.minFillRate=t?.minFillRate??.5,this.scaleConstant=t?.scaleConstant??.4,this.smooth=t?.smooth??.8;const n=this.getCurrentTimeInSeconds();this.lastThrottleTime=n,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(t){if(this.enabled){if(this.refillTokenBucket(),t>this.currentCapacity){const n=(t-this.currentCapacity)/this.fillRate*1e3;await new Promise(r=>setTimeout(r,n))}this.currentCapacity=this.currentCapacity-t}}refillTokenBucket(){const t=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=t;return}const n=(t-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+n),this.lastTimestamp=t}updateClientSendingRate(t){let n;if(this.updateMeasuredRate(),Lr(t)){const a=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=a,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),n=this.cubicThrottle(a),this.enableTokenBucket()}else this.calculateTimeWindow(),n=this.cubicSuccess(this.getCurrentTimeInSeconds());const r=Math.min(n,2*this.measuredTxRate);this.updateTokenBucketRate(r)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(t){return this.getPrecise(t*this.beta)}cubicSuccess(t){return this.getPrecise(this.scaleConstant*Math.pow(t-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(t){this.refillTokenBucket(),this.fillRate=Math.max(t,this.minFillRate),this.maxCapacity=Math.max(t,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const t=this.getCurrentTimeInSeconds(),n=Math.floor(t*2)/2;if(this.requestCount++,n>this.lastTxRateBucket){const r=this.requestCount/(n-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(r*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=n}}getPrecise(t){return parseFloat(t.toFixed(8))}}const ne=100,Re=20*1e3,kt=500,bt=500,St=5,Ct=10,Mt=1,Nr="amz-sdk-invocation-id",Fr="amz-sdk-request",Ur=()=>{let e=ne;return{computeNextBackoffDelay:r=>Math.floor(Math.min(Re,Math.random()*2**r*e)),setDelayBase:r=>{e=r}}},Wr=(e,t,n,r)=>{const a=e,o=St,i=Ct,c=Ur();let d=e,s=Math.min(Re,t),u,p=n??0;const l=b=>b==="TRANSIENT"?i:o,h=()=>p,g=()=>s,m=()=>u,f=b=>l(b)<=d;return{getRetryCount:h,getRetryDelay:g,getLastRetryCost:m,hasRetryTokens:f,getRetryTokenCount:b=>{const S=b.errorType;if(!f(S))throw new Error("No retry token available");const E=l(S),N=S==="THROTTLING"?kt:ne;c.setDelayBase(N);const Ae=c.computeNextBackoffDelay(p);if(b.retryAfterHint){const qt=b.retryAfterHint.getTime()-Date.now();s=Math.max(qt||0,Ae)}else s=Ae;return p++,u=E,d-=E,E},releaseRetryTokens:b=>{d+=b??Mt,d=Math.min(d,a)}}};class Ie{constructor(t){this.maxAttempts=t,this.mode=Y.STANDARD,this.retryToken=Wr(bt,ne),this.maxAttemptsProvider=typeof t=="function"?t:async()=>t}async acquireInitialRetryToken(t){return this.retryToken}async refreshRetryTokenForRetry(t,n){const r=await this.getMaxAttempts();if(this.shouldRetry(t,n,r))return t.getRetryTokenCount(n),t;throw new Error("No retry token available")}recordSuccess(t){this.retryToken.releaseRetryTokens(t.getLastRetryCost())}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Se}`),Se}}shouldRetry(t,n,r){return t.getRetryCount()<r&&t.hasRetryTokens(n.errorType)&&this.isRetryableError(n.errorType)}isRetryableError(t){return t==="THROTTLING"||t==="TRANSIENT"}}class $r{constructor(t,n){this.maxAttemptsProvider=t,this.mode=Y.ADAPTIVE;const{rateLimiter:r}=n??{};this.rateLimiter=r??new _t,this.standardRetryStrategy=new Ie(t)}async acquireInitialRetryToken(t){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(t)}async refreshRetryTokenForRetry(t,n){return this.rateLimiter.updateClientSendingRate(n),this.standardRetryStrategy.refreshRetryTokenForRetry(t,n)}recordSuccess(t){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(t)}}class Vr extends Ie{constructor(t,n=ne){super(typeof t=="function"?t:async()=>t),typeof n=="number"?this.computeNextBackoffDelay=()=>n:this.computeNextBackoffDelay=n}async refreshRetryTokenForRetry(t,n){const r=await super.refreshRetryTokenForRetry(t,n);return r.getRetryDelay=()=>this.computeNextBackoffDelay(r.getRetryCount()),r}}const jr=Object.freeze(Object.defineProperty({__proto__:null,AdaptiveRetryStrategy:$r,ConfiguredRetryStrategy:Vr,DEFAULT_MAX_ATTEMPTS:Se,DEFAULT_RETRY_DELAY_BASE:ne,DEFAULT_RETRY_MODE:xr,DefaultRateLimiter:_t,INITIAL_RETRY_TOKENS:bt,INVOCATION_ID_HEADER:Nr,MAXIMUM_RETRY_DELAY:Re,NO_RETRY_INCREMENT:Mt,REQUEST_HEADER:Fr,RETRY_COST:St,get RETRY_MODES(){return Y},StandardRetryStrategy:Ie,THROTTLING_RETRY_DELAY_BASE:kt,TIMEOUT_RETRY_COST:Ct},Symbol.toStringTag,{value:"Module"})),Hr=tn(jr);var H=v&&v.__assign||function(){return H=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},H.apply(this,arguments)},Rt=v&&v.__awaiter||function(e,t,n,r){function a(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(u){try{s(r.next(u))}catch(p){i(p)}}function d(u){try{s(r.throw(u))}catch(p){i(p)}}function s(u){u.done?o(u.value):a(u.value).then(c,d)}s((r=r.apply(e,t||[])).next())})},It=v&&v.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,a,o,i;return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(s){return function(u){return d([s,u])}}function d(s){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,a&&(o=s[0]&2?a.return:s[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,s[1])).done)return o;switch(a=0,o&&(s=[s[0]&2,o.value]),s[0]){case 0:case 1:o=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,a=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1],o=s;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(s);break}o[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(u){s=[6,u],a=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(B,"__esModule",{value:!0});B.NoOpTracker=B.setupClientListeners=B.TangerineBoxEventTracker=void 0;var ot=Hr,Gr=L,Kr=function(e){return!!(e instanceof Error&&e.$fault&&e.$metadata)},Yr=function(){function e(t){this.scheduledEventTracker=t}return e.getInstance=function(t){try{return new e(Gr.ScheduledEventTracker.getInstance(t))}catch(n){return console.error("[TangerineBox] Telemetry configuration is missing. Error: ".concat(n)),new Dt}},e.prototype.addEvent=function(t,n){this.scheduledEventTracker.addEvent(t,n)},e.prototype.addError=function(t,n,r){this.scheduledEventTracker.addError(t,n,r)},e.prototype.addFatalError=function(t,n,r,a){this.scheduledEventTracker.addFatalError(t,n,r,a)},e.prototype.emitAwsSdkMetrics=function(t,n){var r=this;At(t,function(a){return Rt(r,void 0,void 0,function(){return It(this,function(o){return[2,this.scheduledEventTracker.addAwsSdkEvent(a,n)]})})})},e}();B.TangerineBoxEventTracker=Yr;function At(e,t){var n=this,r,a,o,i=function(){return typeof performance<"u"&&typeof performance.now=="function"?performance.now():Date.now()};e.middlewareStack.add(function(c,d){return function(s){return Rt(n,void 0,void 0,function(){var u,p,l,h,g,m,S,f,y,T,b,S;return It(this,function(E){switch(E.label){case 0:return u=d.commandName.replace(/Command$/,""),p=d.clientName.replace(/Client$/,""),[4,e.config.retryStrategy()];case 1:return l=E.sent(),[4,e.config.maxAttempts()];case 2:return h=E.sent(),l instanceof ot.StandardRetryStrategy?typeof l.maxAttempts!="number"?[3,3]:(g=l.maxAttempts,[3,5]):[3,6];case 3:return[4,l.maxAttempts()];case 4:g=E.sent(),E.label=5;case 5:return h=g,[3,8];case 6:return l instanceof ot.AdaptiveRetryStrategy?[4,l.maxAttemptsProvider()]:[3,8];case 7:h=E.sent(),E.label=8;case 8:return[4,e.config.region()];case 9:a=E.sent(),r=i(),o=Date.now(),E.label=10;case 10:return E.trys.push([10,13,,15]),[4,c(s)];case 11:return m=E.sent(),S=H(H({},at(m.output.$metadata,h)),{latencyMillseconds:Math.max(0,Math.round(i()-r)),operation:u,service:p,region:a,startTimestamp:new Date(o),finalSdkException:void 0,finalAwsException:void 0}),[4,t(S)];case 12:return E.sent(),[2,m];case 13:return f=E.sent(),y=at(f.$metadata,h),T=Kr(f),b=T?void 0:f.message,S=H(H({},y),{latencyMillseconds:Math.max(0,Math.round(i()-r)),operation:u,service:p,region:a,startTimestamp:new Date(o),finalSdkException:T&&f.$fault==="client"?f.name:b,finalAwsException:T&&f.$fault==="server"?f.name:void 0}),[4,t(S)];case 14:throw E.sent(),f;case 15:return[2]}})})}},{step:"serialize",name:"TangerineBoxSDKRequestMetric"})}B.setupClientListeners=At;function at(e,t){var n,r,a;return e?{attemptCount:(n=e.attempts)!==null&&n!==void 0?n:0,finalHttpStatusCode:e.httpStatusCode,maxRetriesExceeded:t<=((r=e.attempts)!==null&&r!==void 0?r:0),finalRequestId:(a=e.requestId)!==null&&a!==void 0?a:void 0}:{attemptCount:0,finalHttpStatusCode:void 0,maxRetriesExceeded:!0,finalRequestId:void 0}}var Dt=function(){function e(){}return e.prototype.addEvent=function(t,n){},e.prototype.addError=function(t,n,r){},e.prototype.addFatalError=function(t,n,r,a){},e.prototype.emitAwsSdkMetrics=function(t,n){},e}();B.NoOpTracker=Dt;var q={};Object.defineProperty(q,"__esModule",{value:!0});q.NoOpScheduledEventTracker=q.TangerineBoxEventTrackerForAwtObserve=void 0;var qr=B,zr=L,Jr=function(){function e(t){this.internalEventTracker=t}return e.getInstance=function(t){return new e(t().then(function(n){return Promise.resolve(zr.ScheduledEventTracker.getInstance(n))}).catch(function(n){return console.error("[TangerineBox] Telemetry configuration is missing. ".concat(n)),Promise.resolve(new Ot)}))},e.prototype.addEvent=function(t,n){this.internalEventTracker.then(function(r){return r.addEvent(t,n)})},e.prototype.addError=function(t,n,r){this.internalEventTracker.then(function(a){return a.addError(t,n,r)})},e.prototype.addFatalError=function(t,n,r,a){this.internalEventTracker.then(function(o){return o.addFatalError(t,n,r,a)})},e.prototype.emitAwsSdkMetrics=function(t,n){var r=this;(0,qr.setupClientListeners)(t,function(a){return r.internalEventTracker.then(function(o){return o.addAwsSdkEvent(a,n)})})},e}();q.TangerineBoxEventTrackerForAwtObserve=Jr;var Ot=function(){function e(){}return e.prototype.addEvent=function(t,n){},e.prototype.addError=function(t,n,r){},e.prototype.addFatalError=function(t,n,r,a){},e.prototype.addAwsSdkEvent=function(t,n){},e}();q.NoOpScheduledEventTracker=Ot;var z={},me={},Xr=v&&v.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(me,"__esModule",{value:!0});me.SdkError=void 0;var Zr=function(e){Xr(t,e);function t(n,r,a){var o=e.call(this,n)||this;return o.message=n,o.code=r,o.originalError=a,o.name=o.constructor.name,a&&(o.stack+=`
Caused by: `+a.stack),o}return t}(Error);me.SdkError=Zr;var Qr=v&&v.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),eo=v&&v.__awaiter||function(e,t,n,r){function a(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(u){try{s(r.next(u))}catch(p){i(p)}}function d(u){try{s(r.throw(u))}catch(p){i(p)}}function s(u){u.done?o(u.value):a(u.value).then(c,d)}s((r=r.apply(e,t||[])).next())})},to=v&&v.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,a,o,i;return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(s){return function(u){return d([s,u])}}function d(s){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,a&&(o=s[0]&2?a.return:s[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,s[1])).done)return o;switch(a=0,o&&(s=[s[0]&2,o.value]),s[0]){case 0:case 1:o=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,a=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1],o=s;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(s);break}o[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(u){s=[6,u],a=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(z,"__esModule",{value:!0});z.TangerineBoxCredentials=z.TangerineBoxCredentialsBase=void 0;var no=me,ro=L,Pt=function(){function e(t){var n=this;this.browserCredentials=t,t.addLogoutListener(function(){n.credentials&&(n.credentials.expiration=new Date(0),n.credentials.accessKeyId="",n.credentials.secretAccessKey="",n.credentials.sessionToken&&(n.credentials.sessionToken=""))})}return e.prototype.getTangerineBoxCredentials=function(){var t=this;return function(){return t.fetchCredentials()}},e.prototype.fetchCredentials=function(){return eo(this,void 0,void 0,function(){var t;return to(this,function(n){switch(n.label){case 0:return t=this,[4,this.browserCredentials.getCredentials().then(function(r){return{expiration:new Date(r.expiration),accessKeyId:r.accessKeyId,secretAccessKey:r.secretAccessKey,sessionToken:r.sessionToken}}).catch(function(r){throw new no.SdkError(r.message,"TangerineBoxCredentialsProviderFailure")})];case 1:return t.credentials=n.sent(),[2,this.credentials]}})})},e}();z.TangerineBoxCredentialsBase=Pt;var oo=function(e){Qr(t,e);function t(n){return e.call(this,n)||this}return t.getInstance=function(){return this.tangerineBoxCredentialsInstance||(this.tangerineBoxCredentialsInstance=new t(ro.BrowserCredentials.getInstance())),this.tangerineBoxCredentialsInstance},t}(Pt);z.TangerineBoxCredentials=oo;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TangerineBoxMetaDataProvider=e.TangerineBoxCredentials=e.TangerineBoxEventTrackerForAwtObserve=e.TangerineBoxEventTracker=void 0;var t=B;Object.defineProperty(e,"TangerineBoxEventTracker",{enumerable:!0,get:function(){return t.TangerineBoxEventTracker}});var n=q;Object.defineProperty(e,"TangerineBoxEventTrackerForAwtObserve",{enumerable:!0,get:function(){return n.TangerineBoxEventTrackerForAwtObserve}});var r=z;Object.defineProperty(e,"TangerineBoxCredentials",{enumerable:!0,get:function(){return r.TangerineBoxCredentials}});var a=L;Object.defineProperty(e,"TangerineBoxMetaDataProvider",{enumerable:!0,get:function(){return a.MetaDataProvider}})})(Pr);const ao=kr.getCreator(ce.DEFAULT_2023_05_15),st=({eventTrackerName:e,token:t})=>{de(e).setEventTrackerConfig({tangerineBoxTelemetry:{token:t}})},so=({eventTrackerName:e,servicePrincipal:t,sinkName:n,sinkType:r})=>{de(wr,{logLevel:C.Info,tangerineBoxTelemetry:{token:Er}}).emitEvent({eventName:"LowercasedFallbackToken",eventType:"log",eventSource:"other",logLevel:C.Info,payload:{eventTrackerName:e,servicePrincipal:t,sinkName:n,sinkType:r===ie.DefaultWidget20230419?"widget":"library"}})},it=async({eventTrackerName:e,eventTrackerConfig:t,eventTrackingSystemConfig:n,sinkType:r})=>{let a=t?.tangerineBoxTelemetry?.servicePrincipal,o=t?.tangerineBoxTelemetry?.sinkName;if(!o||!a){const i=Cr({identifier:o??e});if(i.succeeded===!1)return n&&!n.isProd&&console.error(i.message),Tr+e;a=a??i.servicePrincipal,o=o??i.telemetrySinkName,e!==e.toLowerCase()&&so({eventTrackerName:e,servicePrincipal:a,sinkName:o,sinkType:r})}return await ao.createTenantToken(a,o,r)},io=async({eventTrackerConfig:e,eventTrackerName:t,eventTrackingSystemConfig:n,sinkType:r})=>{const o=de(t,e).getEventTrackerConfig();let i=o?.tangerineBoxTelemetry?.token;i||(i=await it({eventTrackerName:t,eventTrackerConfig:e,eventTrackingSystemConfig:n,sinkType:r})),st({eventTrackerName:t,token:i});let c=o?.tangerineBoxTelemetry?.parentToken;const d=o?.tangerineBoxTelemetry?.parentName,s=e?.tangerineBoxTelemetry?.tokensForPublicEvents;if(!s&&!c&&d){const l=de(d).getEventTrackerConfig();c=l?.tangerineBoxTelemetry?.token,c||(c=await it({eventTrackerName:d,eventTrackerConfig:l,eventTrackingSystemConfig:n,sinkType:r}),st({eventTrackerName:d,token:c}))}const u={token:i};return s?u.tokensForPublicEvents=s:u.parentToken=c,u},co=["aws","aws-cn","aws-us-gov","aws-iso","aws-iso-b","aws-iso-c","aws-iso-d","aws-iso-e","aws-iso-f","aws-eusc"],uo="__ENABLE_ALLOWED_ACCOUNTS_MODULES__",lo=/\${([^}]*)}/g,fo=(e,t)=>e.indexOf("${")===-1?e:e.replace(lo,(n,r)=>{const a=t(r);return typeof a=="string"?a:n}),Ce=(e,t)=>{if(e)if(Array.isArray(e)){let n;const r=e.length;for(let a=0;a<r;a++){const o=e[a],i=Ce(o,t);i!==o&&(n||(n=[...e]),n[a]=i)}return n||e}else if(typeof e=="object"){let n;for(const[r,a]of Object.entries(e)){const o=Ce(a,t);o!==a&&(n||(n={...e}),n[r]=o)}return n||e}else return typeof e=="string"?fo(e,t):e;else return e},po=(e,t)=>Ce(e,n=>t[n]),xt=e=>e.status==="fulfilled",ho=e=>e.value!==void 0,vo=e=>async(t,n=ho)=>{const r={success:[],failure:[]},a=await Promise.allSettled(e.map(t));for(const o of a)xt(o)?n(o)?r.success.push(o.value):r.failure.push({status:"rejected",reason:{msg:"ERR_PREDICATE",value:o.value}}):r.failure.push(o);return r},go=e=>{try{return e.cookie.split(";").reduce((t,n)=>{const[r,a]=n.split("=").map(o=>o.trim());return{...t,[r]:a}},{})}catch{return}},yo=2,mo=100,Eo=(e,t)=>{const n=Math.random()*2**e*t;return new Promise(r=>setTimeout(r,n))},To=async(e,{maxRetries:t=yo,delayInMs:n=mo,onAttemptFailed:r}={})=>{const a=o=>{try{r?.(o)}catch{}};for(let o=0;o<=t;o++){const i=performance.now();try{return await e()}catch(c){if(a({error:c,attemptCount:o,durationInMs:performance.now()-i}),o===t)throw c}await Eo(o,n)}throw new Error("Unexpected error during retry. Maximum retries exceeded.")},Te=async e=>import(e),wo=()=>{const e=new Map;return{getEntry:t=>e.get(t),setSucceededEntry:(t,n)=>e.set(t,{succeeded:!0,cachedPath:n}),setFailedEntry:t=>e.set(t,{succeeded:!1}),clear:()=>e.clear()}},se=wo(),ct=async(e,t)=>To(async()=>{const r=se.getEntry(e);if(r){if(r.succeeded)return Te(r.cachedPath);const o=`${e}?t=${Date.now()}`,i=await Te(o);return se.setSucceededEntry(e,o),i}se.setFailedEntry(e);const a=await Te(e);return se.setSucceededEntry(e,e),a},t);class _o{lotusPackages;_getModuleMetadata;_discoveredModules={};onModuleLoadFailed;onModuleMetadataLoadFailed;accessControlOverridden;getPackageMetadataComplete;constructor({lotusPackages:t,getModuleMetadata:n,on:r}){this.lotusPackages=t,this._getModuleMetadata=n,this.onModuleLoadFailed=r?.moduleLoadFailed,this.onModuleMetadataLoadFailed=r?.moduleMetadataLoadFailed,this.accessControlOverridden=go(document)?.[uo]!==void 0,this.getPackageMetadataComplete=r?.getPackageMetadataComplete}discoverModuleByModuleId=async t=>{const n=this._getLotusPackage(t);if(n){if(this._discoveredModules[t]===void 0){const{frontendPkg:r,accessControl:a="ANY_ACCOUNT"}=n;try{const{token:o}=await io({eventTrackerName:t,eventTrackerConfig:{},sinkType:ie.DefaultWidget20230419});if(!(a==="ANY_ACCOUNT"||this.accessControlOverridden)){this._discoveredModules[t]=!1;return}const{basePath:c}=await mr({packageName:r.packageName,majorVersion:r.majorVersion.toString(),telemetryToken:o,onComplete:this.getPackageMetadataComplete}),d=`${c}${en}`,s=`${c}${Qt}`,u=this._getModuleMetadata?await this._getModuleMetadata(s):(await ct(s,{onAttemptFailed:g=>{this.onModuleMetadataLoadFailed?.({...g,moduleId:t,url:s})}})).moduleMetadata,l={...po(u,{moduleAssetsUrlPrefix:c.endsWith("/")?c.slice(0,-1):c}),moduleBaseUrl:c},h={loader:async()=>(await ct(d,{onAttemptFailed:g=>{this.onModuleLoadFailed?.({...g,moduleId:t,url:d})}})).module,metadata:l};this._discoveredModules[t]=h}catch(o){throw this._discoveredModules[t]=!1,o}}return this._discoveredModules[t]||void 0}};discoverModulesWithContributions=async t=>{const n=this.lotusPackages.filter(({contributionPointsId:r=[]})=>r.includes(t));if(n.length){const r=n.map(async({moduleId:o})=>this.discoverModuleByModuleId(o));return(await Promise.allSettled(r)).filter(xt).map(({value:o})=>o).filter(o=>o?.metadata.contributes?.[t])}return[]};_getLotusPackage=t=>this.lotusPackages.find(({moduleId:n})=>n===t)}const ko=(e,t,n)=>new _o({lotusPackages:e,getModuleMetadata:t,on:n}),bo={discoverModuleByModuleId:async()=>{},discoverModulesWithContributions:async()=>[]},So=e=>{const t={};for(const n of Object.values(e)){const r=Object.keys(n.metadata.contributes||{});for(const a of r)(t[a]||(t[a]=[])).push(n)}return t},Co=e=>{if(e){const t=So(e);return{discoverModuleByModuleId:async n=>e[n],discoverModulesWithContributions:async n=>t[n]||[]}}return bo},Mo=(e,t)=>{const n=vo(e);return{discoverModuleByModuleId:async r=>{const{success:[a],failure:o}=await n(i=>i.discoverModuleByModuleId(r));return o.length,a},discoverModulesWithContributions:async r=>{const{success:a}=await n(c=>c.discoverModulesWithContributions(r)),o=a.flat(1),i=[];for(const c of o)i.find(({metadata:{moduleId:s}})=>s===c.metadata.moduleId)||i.push(c);return i}}},Ro="a/v1/744ISZS66HTVSANJ4WUULSF6JFUPMJJGPSQDOLYAZLIJWF2HW56A/index.js",Ee={BUNDLED:"BUNDLED",LOTUS:"LOTUS"},Io=e=>e.__type===Ee.BUNDLED,Ao=e=>e.__type===Ee.LOTUS,Do=e=>({...e,__type:Ee.LOTUS}),Oo=e=>({...e,__type:Ee.BUNDLED}),Po=()=>{const t=L.MetaDataProvider.getInstance().getCdnUrl(Ro);if(!t||!/^http(s?):\/\//.test(t))throw new Error("CDN URL not found!");return t},xo=()=>{const e=document.querySelector('meta[name="tb-data"]');try{return e&&JSON.parse(e.content).nav2Enabled}catch{return!1}},Bo=async({enableLoaderFallback:e})=>{if(e&&!xo()&&!document.querySelector("script[data-unified-console-app-loader]"))try{const t=Po(),n=document.createElement("script");n.setAttribute("data-unified-console-app-loader",""),n.setAttribute("data-platform-asset","unified-console"),n.setAttribute("type","module"),n.setAttribute("async","async"),n.setAttribute("crossorigin","anonymous"),n.src=t,document.head.appendChild(n)}catch{console.warn("Asset Endpoint not found!")}};var I;(function(e){e.None="none",e.Pink="pink",e.Purple="purple",e.Blue="blue",e.LightBlue="lightBlue",e.Teal="teal",e.Green="green",e.Yellow="yellow",e.Orange="orange",e.Red="red"})(I||(I={}));I.Pink+"",I.Purple+"",I.Blue+"",I.LightBlue+"",I.Teal+"",I.Green+"",I.Yellow+"",I.Orange+"",I.Red+"";const Lo=[],Bt=new Set,Lt=new Set,ut=(e,t)=>{for(const n of e)t.add(n)},Nt=e=>e.hasAttribute("sandbox")&&!e.getAttribute("sandbox")?.includes("allow-same-origin"),Ft=e=>!Nt(e)&&!!(e.contentDocument&&e.contentDocument.body),No=e=>{e.nodeName==="IFRAME"&&(Ft(e)?Bt.delete(e):Lt.delete(e))},Fo={attributes:!0,childList:!0,subtree:!0},Ut=(e,t,n=!1)=>{const r=[],a=[];return e&&(n&&t.observe(e,Fo),[...e.getElementsByTagName("iframe")].forEach(i=>{if(Ft(i)){r.push(i);const{sameOriginIframes:c,crossOriginIframes:d}=Ut(i.contentDocument?.body,t,!0);r.push(...c),a.push(...d)}else Nt(i)||a.push(i)})),{sameOriginIframes:r,crossOriginIframes:a}},Uo=(e,t,n)=>{const r=new Set,a=new Set;t?.length&&t.forEach(o=>r.add(o)),n?.length&&n.forEach(o=>a.add(o)),e.forEach(o=>{o(r,a)})},Wo=e=>{for(const t of e){if(t.type==="childList"&&t.addedNodes.length){const{sameOriginIframes:n,crossOriginIframes:r}=Ut(t.target,$o);Uo(Lo,n,r),ut(n,Bt),ut(r,Lt)}if(t.type==="childList")for(let n=0;n<t.removedNodes.length;n++)No(t.removedNodes[n])}},$o=new MutationObserver(Wo);var Me;(function(e){e.Dark="dark",e.Light="light"})(Me||(Me={}));Me.Light;var dt;(function(e){e.CCS="ccs",e.ColorTheme="color_theme",e.DefaultLanguage="default_language",e.DefaultRegion="default_region",e.FavoriteBar="favorite_bar",e.Timezone="time_zone",e.FavoritesInUnifiedSearch="favorites_unified_search",e.LanguageSelectorInNav="language_selector_in_nav",e.KrakenInUnifiedSearch="kraken_in_unified_search",e.NewUnifiedSearchDomainInUnifiedSearch="new_unifiedsearch_domain_in_unified_search",e.UnifiedSearchAWTInNonPublic="unified_search_awt_nonpublic",e.VPC="vpc",e.EnabledRegions="enabled_regions",e.SearchServices="search_services",e.LegacyFeedback="legacy_feedback",e.Aperture="aperture",e.SettingManagement="setting_management",e.DisableAllServicesLink="disable_all_services_link",e.SendAllMetricsToPanorama="send_all_metrics_to_panorama",e.Paddy="paddy",e.BrowserFavicon="browser_favicon",e.PageTitle="page_title",e.ConsoleNotificationsWidget="console_notifications_widget",e.ACMASmartAppBanner="acma_smart_app_banner",e.CSVRAnnouncement="cs_vr_announcement"})(dt||(dt={}));var lt;(function(e){e.Enabled="enabled",e.Disabled="disabled"})(lt||(lt={}));const Vo="ServiceListUpdated",jo="ServiceListError",Ho=()=>window.AWSC?.CCS?.initialUserServiceList,Wt=new Set,le=(e,t=!1,n)=>({data:e,isLoading:t,error:n,isError:!!n}),$t=(e=[],t={})=>e.filter(n=>{if(t[n]){const{unlisted:r,history:a}=t[n];return!r||r&&a}return!1}),Vt=(e=[],t={})=>e.filter(n=>t[n]&&!t[n].unlisted),Go=({detail:e})=>{const t=window.ConsoleNavService?.Model?.servicesById,n=e?.recentlyVisitedServiceIdList?$t(e.recentlyVisitedServiceIdList,t):null,r=e?.favoriteServiceIdList?Vt(e.favoriteServiceIdList,t):null;for(const a of Wt)a({...r&&{favorite:le(r)},...n&&{recentlyVisited:le(n)}})},Ko=({detail:e})=>{const t=window.ConsoleNavService?.Model?.servicesById,n=Ho(),r=n?.recentlyVisitedServiceIdList,a=n?.favoriteServiceIdList,o=$t(r,t),i=Vt(a,t);for(const c of Wt)c({recentlyVisited:le(o,!1,e),favorite:le(i,!1,e)})},Yo=()=>{window.addEventListener(Vo,Go)},qo=()=>{window.addEventListener(jo,Ko)};Yo();qo();function zo(){const e=document.location.hostname;return/.console.aws-dev./.test(e)?"dev":/.awsc-integ./.test(e)?"integ":"public"}const Jo=e=>{const t=zo();return e.filter(({consoleEnvironments:n})=>!Array.isArray(n)||n?.length===0||n?.length>0&&n.includes(t))},Xo=async()=>{try{const t=await te.getInstance().getSessionARN();if(t){const n=t.split(":")?.[1];if(co.includes(n))return n}}catch{}return null},Zo=async e=>{const t=await Xo();return e.filter(({partitions:n})=>!Array.isArray(n)||t&&n.includes(t))},Qo=({lotusPackages:e,getRemoteModuleMetadata:t})=>{const r=(async()=>{const a=Jo(await Zo(e));return ko(a,t)})();return{discoverModuleByModuleId:async a=>(await r).discoverModuleByModuleId(a),discoverModulesWithContributions:async a=>(await r).discoverModulesWithContributions(a)}},ea=({modules:e,initialMessages:t=[],getRemoteModuleMetadata:n,enableLoaderFallback:r=!1})=>{Bo({enableLoaderFallback:r});const a={},o=[];e.forEach(c=>{if(Io(c)){const{__type:d,...s}=c;a[s.metadata.moduleId]=s}if(Ao(c)){const{__type:d,...s}=c;o.push(s)}});const i=Mo([Qo({lotusPackages:o,getRemoteModuleMetadata:n}),Co(a)]);return{discoverModuleByModuleId:c=>i.discoverModuleByModuleId(c),discoverModulesWithContributions:async c=>i.discoverModulesWithContributions(c),getInitialMessages:()=>t}},ta=e=>{const t=[],n={lotus:r=>{const a=Array.isArray(r)?r:[r];if(a?.every?.(o=>!!o?.moduleId&&!!o?.frontendPkg))return t.push(...a.map(Do)),n;throw new Error("Invalid Lotus Module")},bundled:r=>{const a=Array.isArray(r)?r:[r];if(a?.every?.(o=>!!o?.loader&&!!o?.metadata&&o?.metadata?.moduleId))return t.push(...a.map(Oo)),n;throw new Error("Invalid Bundled Module")}};return e(n),t},re="tools-experience",na={hasReply:!1},ra={hasReply:!0},oa={withPayload:()=>na,withPayloadAndReply:()=>ra},aa=":REPLY",sa=({namespace:e,type:t,hasReply:n,to:r})=>{const a=`${e}/${t}`,o=n?`${a}${aa}`:void 0;return{type:a,replyType:o,create:c=>{const d={...c,type:a};return r&&(d.to=r),d},createReply:c=>{if(!n)throw Error(`Message type (${a}) does not support replies`);return{...c,type:o}},matches:c=>c?.type===a,matchesReply:c=>c?.type===o,createHandler:c=>c}},oe=(e,t)=>{if(pt(e))throw Error("Namespace is required");const n={},r=t(oa);for(const[a,{hasReply:o}]of Object.entries(r))n[a]=sa({namespace:e,type:a,hasReply:o});return n},ia={withData:()=>({})},ca=(e,t)=>{if(pt(e))throw Error("Namespace is required");const n={},r=t(ia);for(const[a]of Object.entries(r)){const o={id:`${e}/${a}`,create:i=>i};n[a]=o}return n},jt=oe(re,({withPayload:e,withPayloadAndReply:t})=>({openToolsExperienceWithReply:t(),closeToolsExperienceWithReply:t(),setActiveToolId:e(),mount:t(),openTool:t(),closeTool:t(),onCustomInfoFollow:e(),onPreferencesConfirmStatus:e(),toggleBadgeNotification:t()})),ua=({namespace:e,type:t})=>({type:`${e}/${t}`}),da={withProps:()=>({})},la=(e,t)=>{/* istanbul ignore if -- @preserve */if(e.trim()==="")throw Error("namespace is required");const n={},r=t(da);for(const a of Object.keys(r))n[a]=ua({namespace:e,type:a});return n},Ht="InternalError",fa="MountError",pa="[Mount] The mount handler returned unsuccessfully.",ha="[Mount] An unknown error occurred during mount. This likely indicates a timeout.";fe({errorCode:fa,errorMessage:pa});fe({errorCode:Ht,errorMessage:ha});const va="UpdateError",ga="[Update] The update handler returned unsuccessfully.",ya="[Update] An unknown error occurred during update. This likely indicates a timeout.";fe({errorCode:va,errorMessage:ga});fe({errorCode:Ht,errorMessage:ya});oe("awt-module-views",({withPayload:e,withPayloadAndReply:t})=>({mount:t(),unmount:e(),update:t()}));la(re,({withProps:e})=>({Tool:e(),ToolPreferences:e()}));const ma=ca(re,({withData:e})=>({tool:e()})),Ea=({ingressPointIdentifier:e,activeToolId:t,props:n})=>jt.openToolsExperienceWithReply.create({to:re,payload:{ingressPointIdentifier:e,activeToolId:t,props:n}}),Ta=({moduleContext:e,payload:t})=>e.sendAskMessage(jt.openTool.create({to:re,payload:t})),Gt="awsc-fms-provider-module",wa=oe(Gt,({withPayloadAndReply:e})=>({evaluateFeatures:e()})),Kt="page-context-provider",_a=oe(Kt,({withPayloadAndReply:e})=>({getRegion:e(),getSelectedRegion:e(),getConsoleRegion:e(),getService:e(),getLocale:e(),getAwsUserInfo:e(),getIsUserOnVPCE:e(),getCurrentRegionName:e(),getSessionData:e(),getRegionsAvailability:e()}));var ft;(function(e){e.Dev="dev",e.Beta="beta",e.Gamma="gamma",e.Prod="prod"})(ft||(ft={}));const ka=60*1e3,ba=async e=>(await e.sendAskMessage(_a.getService.create({to:Kt,payload:{}}),{timeoutInMs:ka})).payload,Sa=async e=>{try{const t=await ba(e);return t.succeeded&&t.service?t.service:"unknown"}catch{return"unknown"}};zt();const Yt="livetail-proxy",Ca=oe(X,({withPayload:e})=>({mount:e()})),Ma=ta(({lotus:e,bundled:t})=>{e({frontendPkg:{packageName:Jt,majorVersion:Xt},moduleId:X,partitions:["aws"],contributionPointsId:[ma.tool.id]}),t({metadata:{moduleId:Yt,moduleVersion:"1"},loader:async()=>({activate(n){const r=Zt();r.isModuleFeatureEnabled=async a=>{try{const o=await Sa(n),{payload:i}=await n.sendAskMessage(wa.evaluateFeatures.create({to:Gt,payload:{visitorId:a.accountId,projectId:De.toolCondition.projectId,evaluationContext:{serviceId:o,...a},region:a.region}}));if(!i.succeeded)return!1;const{enabledKey:c,disabledKey:d}=De.toolCondition;return!!i?.evaluatedFeatures[c]&&!i?.evaluatedFeatures[d]}catch{return!1}},r.addEventListener(Oe.openLiveTailTool,a=>{Ta({moduleContext:n,payload:{toolId:X,props:a?.detail?.props??{}}})}),r.addEventListener(Oe.openLegacyBottomDrawer,a=>{n.sendAskMessage(Ea({activeToolId:`${X}:${X}`,ingressPointIdentifier:a?.detail?.props?.ingressPointIdentifier}))})}})})}),Ia=ea({modules:Ma,initialMessages:[Ca.mount.create({to:Yt,payload:{}})],enableLoaderFallback:!0});export{Ia as default};
